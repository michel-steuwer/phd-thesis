% Chapter 5: Code generation using patterns

\chapter{Code generation using patterns}

\label{ch:fifth} % For referencing the chapter elsewhere, use \autoref{ch:name} 
\label{chapter:codeGeneration}

In the previous two chapters we discussed how regular parallel pattern, referred to as \emph{algorithmic skeletons}, help to simplify programming of modern parallel systems.
Parallel programming of multi-\GPU systems is considerably simplified without sacrificing performance as shown by the evaluation in \autoref{chapter:skelcl-evaluation}.

In this chapter, we address the second main challenge identified in \autoref{ch:introduction}: \emph{Performance portability}.
We will present a novel approach for generating efficient and hardware-specific code from compositions of algorithmic skeletons and similar high-level \emph{patterns}.
This systematic, rule-based approach provides performance portability across different types of modern parallel processors. 
In the following \autoref{chapter:codeGeneration-evaluation} we will use a set of example applications to show that our approach generates code matching the performance of highly tuned implementations on \CPUs and \GPUs.

We will start this chapter by looking at optimizations in \OpenCL and how applying them changes the source code of applications.
We will show that these optimizations are often hardware-specific thus breaking portability: optimizations for one particular hardware architecture can lead to poor performance on other hardware architectures.
This will motivate the necessity, when aiming for performance portability, for generating optimized and specialized code from a pattern-based high-level representation.
We will discuss the benefits this code generation approach offers over a library-based approach like \SkelCL presented in \autoref{chapter:skelcl}.
Then we will give an overview of our approach and present it in more detail in the following sections.
\autoref{chapter:codeGeneration-evaluation} will present an evaluation of the approach using a set of application studies.

\newpage

\input{Chapters/Chapter5/motivation.tex}

\input{Chapters/Chapter5/overview.tex}

\input{Chapters/Chapter5/patterns.tex}

\input{Chapters/Chapter5/rules.tex}

\input{Chapters/Chapter5/generator.tex}

\section{Summary}
\todo{List contributions and benefits of using the pattern code generator approach}

